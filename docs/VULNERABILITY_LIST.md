# ðŸ”“ Vulnerability List â€” Vulnerable E-Commerce Platform

> **Total: 45+ intentional security vulnerabilities**

---

## ðŸ“‹ Vulnerability Matrix

| # | Category | Vulnerability | Severity | File(s) | OWASP Mapping | PortSwigger Category |
|---|----------|--------------|----------|---------|---------------|---------------------|
| 1 | **Authentication** | Account enumeration (registration) | Medium | `auth.controller.js` | A07:2021 | Authentication |
| 2 | **Authentication** | Account enumeration (login) | Medium | `auth.controller.js` | A07:2021 | Authentication |
| 3 | **Authentication** | Mass assignment â€” user role on registration | Critical | `auth.controller.js` | A01:2021 | Access Control |
| 4 | **Authentication** | Missing HttpOnly/Secure cookie flags | High | `auth.controller.js` | A05:2021 | Authentication |
| 5 | **Authentication** | Refresh token reuse (not invalidated) | High | `auth.controller.js` | A07:2021 | Authentication |
| 6 | **Authentication** | Predictable password reset tokens | Medium | `auth.controller.js` | A02:2021 | Authentication |
| 7 | **Authentication** | Reset token returned in API response | High | `auth.controller.js` | A07:2021 | Authentication |
| 8 | **Authentication** | Weak JWT secret (`secret123`) | Critical | `utils/jwt.js` | A02:2021 | JWT |
| 9 | **Authentication** | JWT algorithm `none` accepted | Critical | `utils/jwt.js` | A02:2021 | JWT |
| 10 | **Authentication** | JWT claim tampering (role in token) | High | `utils/jwt.js` | A01:2021 | JWT |
| 11 | **Authentication** | Low bcrypt salt rounds | Medium | `utils/password.js` | A02:2021 | Cryptography |
| 12 | **Authentication** | No DB verification of JWT user | High | `authenticate.js` | A01:2021 | Authentication |
| 13 | **Authorization** | IDOR â€” order details | High | `order.controller.js` | A01:2021 | Access Control |
| 14 | **Authorization** | IDOR â€” payment operations | High | `payment.controller.js` | A01:2021 | Access Control |
| 15 | **Authorization** | IDOR â€” cart item update/delete | Medium | `cart.controller.js` | A01:2021 | Access Control |
| 16 | **Authorization** | IDOR â€” address update/delete | Medium | `user.controller.js` | A01:2021 | Access Control |
| 17 | **Authorization** | IDOR â€” payment method delete | Medium | `user.controller.js` | A01:2021 | Access Control |
| 18 | **Authorization** | IDOR â€” review update/delete | Medium | `review.controller.js` | A01:2021 | Access Control |
| 19 | **Authorization** | IDOR â€” invoice generation | Medium | `export.controller.js` | A01:2021 | Access Control |
| 20 | **Authorization** | IDOR â€” OAuth account unlinking | Medium | `oauth.controller.js` | A01:2021 | Access Control |
| 21 | **Authorization** | Weak role check for order status update | High | `order.controller.js` | A01:2021 | Access Control |
| 22 | **Authorization** | No product ownership check (CRUD) | High | `product.controller.js` | A01:2021 | Access Control |
| 23 | **Authorization** | Mass assignment on profile update (role) | Critical | `user.controller.js` | A01:2021 | Access Control |
| 24 | **Injection** | SQL Injection (product search) | Critical | `product.controller.js` | A03:2021 | SQL Injection |
| 25 | **Injection** | SQL Injection (legacy debug endpoint) | Critical | `legacy.routes.js` | A03:2021 | SQL Injection |
| 26 | **Injection** | Stored XSS (product reviews) | High | `review.controller.js` | A03:2021 | XSS |
| 27 | **Injection** | Code injection via eval() | Critical | `legacy.routes.js` | A03:2021 | Code Injection |
| 28 | **Injection** | CSV Injection (order/user/audit exports) | Medium | `export.controller.js` | A03:2021 | Injection |
| 29 | **Business Logic** | Price manipulation (cart) | High | `cart.controller.js` | A04:2021 | Business Logic |
| 30 | **Business Logic** | Price manipulation (payments) | High | `payment.controller.js` | A04:2021 | Business Logic |
| 31 | **Business Logic** | Coupon reuse (no per-user tracking) | Medium | `order.controller.js` | A04:2021 | Business Logic |
| 32 | **Business Logic** | Payment replay (no idempotency) | High | `payment.controller.js` | A04:2021 | Business Logic |
| 33 | **Business Logic** | Refund abuse (no amount/ownership check) | High | `payment.controller.js` | A04:2021 | Business Logic |
| 34 | **Business Logic** | Race condition (checkout stock depletion) | High | `order.controller.js` | A04:2021 | Race Conditions |
| 35 | **Business Logic** | Webhook blind trust (payload manipulation) | High | `webhook.controller.js` | A04:2021 | Business Logic |
| 36 | **Business Logic** | Weak webhook signature verification | Medium | `webhook.controller.js` | A02:2021 | Business Logic |
| 37 | **Business Logic** | No webhook replay protection | Medium | `webhook.controller.js` | A04:2021 | Business Logic |
| 38 | **File Handling** | Unrestricted file upload (no MIME check) | High | `utils/upload.js` | A04:2021 | File Upload |
| 39 | **SSRF** | SSRF â€” product image fetch from URL | High | `product.controller.js` | A10:2021 | SSRF |
| 40 | **SSRF** | SSRF â€” webhook config URL | High | `webhook.controller.js` | A10:2021 | SSRF |
| 41 | **SSRF** | SSRF â€” invoice template URL | High | `export.controller.js` | A10:2021 | SSRF |
| 42 | **Configuration** | CORS misconfiguration (any origin + creds) | High | `app.js` | A05:2021 | CORS |
| 43 | **Configuration** | Missing security headers (Helmet disabled) | Medium | `app.js` | A05:2021 | Clickjacking |
| 44 | **Configuration** | Verbose error responses (stack traces) | Medium | `app.js` | A05:2021 | Information Disclosure |
| 45 | **Configuration** | Environment variable exposure (health check) | Medium | `app.js` | A05:2021 | Information Disclosure |
| 46 | **Configuration** | Full config/env leak (legacy /api/v2/config) | Critical | `legacy.routes.js` | A05:2021 | Information Disclosure |
| 47 | **Data Exposure** | Excessive data in admin user view | Medium | `admin.controller.js` | API3:2019 | Information Disclosure |
| 48 | **Data Exposure** | Sensitive data in audit logs | Medium | `utils/auditLog.js` | A09:2021 | Information Disclosure |
| 49 | **Data Exposure** | Password hashes in legacy API | Critical | `legacy.routes.js` | A01:2021 | Information Disclosure |
| 50 | **Data Exposure** | Refresh tokens in legacy API | Critical | `legacy.routes.js` | A01:2021 | Information Disclosure |
| 51 | **Data Exposure** | Raw card data in payment metadata | High | `payment.controller.js` | A02:2021 | PCI Violation |
| 52 | **Data Exposure** | Webhook secrets in config list | Medium | `webhook.controller.js` | A02:2021 | Information Disclosure |
| 53 | **OAuth** | Missing state parameter (CSRF in OAuth) | High | `oauth.controller.js` | A01:2021 | OAuth |
| 54 | **OAuth** | Unverified OAuth id_token | High | `oauth.controller.js` | A07:2021 | OAuth |
| 55 | **OAuth** | Account linking without re-auth | High | `oauth.controller.js` | A01:2021 | OAuth |
| 56 | **OAuth** | OAuth account takeover via email trust | Critical | `oauth.controller.js` | A01:2021 | OAuth |
| 57 | **OAuth** | Insecure callback (query param fallback) | High | `oauth.controller.js` | A07:2021 | OAuth |
| 58 | **Legacy API** | Unauthenticated legacy endpoints | Critical | `legacy.routes.js` | A01:2021 | Access Control |
| 59 | **Legacy API** | Mass assignment via PUT /api/v2/users/:id | Critical | `legacy.routes.js` | A01:2021 | Access Control |
| 60 | **Legacy API** | Static files without auth | Low | `app.js` | A01:2021 | Access Control |
| 61 | **Email** | Verification token acceptance without validation | Medium | `user.controller.js` | A07:2021 | Authentication |
| 62 | **Email** | Sensitive data in mock email logs | Low | `utils/email.js` | A09:2021 | Information Disclosure |

---

## Vulnerability Categories Covered

| Category | Count |
|----------|-------|
| Authentication / Session | 12 |
| Authorization / Access Control | 12 |
| Injection (SQLi, XSS, Code, CSV) | 5 |
| Business Logic | 9 |
| SSRF | 3 |
| File Upload | 1 |
| OAuth Vulnerabilities | 5 |
| Configuration / Misconfiguration | 5 |
| Data Exposure / Information Disclosure | 8 |
| Legacy API | 3 |
| **Total** | **62** |

---

## OWASP Top 10 Coverage

| OWASP Category | Vulns |
|---------------|-------|
| A01:2021 â€“ Broken Access Control | 20+ |
| A02:2021 â€“ Cryptographic Failures | 6 |
| A03:2021 â€“ Injection | 5 |
| A04:2021 â€“ Insecure Design | 8 |
| A05:2021 â€“ Security Misconfiguration | 5 |
| A07:2021 â€“ Identification and Authentication Failures | 8 |
| A09:2021 â€“ Security Logging and Monitoring Failures | 2 |
| A10:2021 â€“ Server-Side Request Forgery | 3 |

## PortSwigger Categories Covered

- âœ… SQL Injection
- âœ… Cross-Site Scripting (XSS)
- âœ… Cross-Site Request Forgery (CSRF)
- âœ… Server-Side Request Forgery (SSRF)
- âœ… Access Control Vulnerabilities
- âœ… Authentication Vulnerabilities
- âœ… JWT Vulnerabilities
- âœ… OAuth Authentication Vulnerabilities
- âœ… Business Logic Vulnerabilities
- âœ… File Upload Vulnerabilities
- âœ… Information Disclosure
- âœ… Clickjacking
- âœ… Race Conditions
- âœ… Server-side Code Injection
